import{d as q,R as F,D as J,B as X,S as j,a as w,q as G,U as Q,s as W,r as H,t as Y,x as l,y as g,z as y,b as c,F as h,C as e,N as Z,Q as C,V as u,I as x,G as ee,E as r,M as f,W as te}from"./index-cdcf547c.js";import{u as ae}from"./use-menu-b48628b9.js";import{A as E}from"./ApiUser-6badb945.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";const oe=q({components:{"a-form":F,"a-form-item":F.Item,"a-drawer":J,"a-button":X,"a-input-number":j},setup(){ae().onSelectedKeys(["admin-users"]);const a=w(G().user.roleClaimDetail),i="http://localhost:9000",z=Q(),A=W(),$=w(!1),O=w({}),I=JSON.parse(localStorage.getItem("auth")).storeId,_=w([]),S=w([]),v=JSON.parse(localStorage.getItem("token")),k=w(""),n=H({currentPage:1,pageSize:10,totalItems:0,totalPages:0}),P=[{title:"#",key:"index"},{title:"Ảnh sản phẩm",dataIndex:"imageSp",key:"imageSp"},{title:"Tên sản phẩm",dataIndex:"userName",key:"userName"},{title:"số lượng",dataIndex:"fullName",key:"fullName"},{title:"tồng tiền",key:"email"},{title:"trạng thái",key:"status"},{title:"Tác vụ",key:"action",fixed:"right"}],D=s=>{try{const t=s.slice(2,4),T=s.slice(5,7),m=s.slice(8,10),U=s.slice(11,13),M=s.slice(14,16),R=s.slice(17,19);return`${U}:${M}:${R}    ${m}-${T}-${t}`}catch(t){return console.error("Error formatting date:",t),"Invalid date"}return`${hours}:${minutes}:${seconds} ${day}-${month}-${year}`},p=(s,t,T="")=>{C.get(`${i}/api/v1/management/${I}/order/view`,{headers:{Authorization:`Bearer ${v}`},params:{page:s,size:t,keyword:T}}).then(m=>{console.log(m.data.data,"response"),S.value=m.data.data,n.totalItems=m.data.pagination.totalItems,n.totalPages=m.data.pagination.totalPages}).catch(m=>{console.error(m)})},B=s=>{switch(s){case 1:return"Ngày đặt hàng";case 2:return"Ngày giao hàng";case 3:return"Ngày giao thành công";case 4:return"Ngày hủy đơn";default:return"Trạng thái không xác định"}},o=async s=>{const{data:t}=await C.get(`${i}/api/v1/management/${I}/orderdetail/view/${s}`,{headers:{Authorization:`Bearer ${v}`}});console.log(t,"ccd"),O.value=t.data},b=s=>{E.DeleteById(s).then(t=>{console.log(t),t.status==200&&u.success("Xóa thành công!"),p(n)}).catch(t=>{u.error(t.message),t.response.data.hasOwnProperty("errors")?_.value=t.response.data.errors:_.value=t.response.data})},d=async s=>{try{const t=await C.get(`${i}/api/v1/shipper/changestatus1/${s}`,{headers:{Authorization:`Bearer ${v}`}});u.success("success")}catch(t){u.error(t.response.data.message)}},N=async s=>{try{const t=await C.get(`${i}/api/v1/shipper/changestatus2/${s}`,{headers:{Authorization:`Bearer ${v}`}});u.success("success")}catch(t){u.error(t.response.data.message)}},V=s=>{E.BannedById(s).then(t=>{t.status==200?u.success("Khóa thành công!"):u.error("Lỗi! Tác vụ thực hiện không thành công."),p(n)}).catch(t=>{u.error(t.message),t.response.data.hasOwnProperty("errors")?_.value=t.response.data.errors:_.value=t.response.data})},K=(s,t)=>{n.currentPage=s,n.pageSize=t,p(s,t,k.value)},L=()=>{n.currentPage=1,p(n.currentPage,n.pageSize,k.value)};return Y(()=>{p(n.currentPage,n.pageSize)}),{route:A,formatDate:D,getOrderStatusLabel:B,router:z,authStoreClaim:a,errors:_,users:S,columns:P,pageParam:n,onChange:K,clickFrmFilter:s=>{n.statusFilter=!0,p(n)},confirmRemove:b,confirmBanned:V,showDrawer:s=>{$.value=!0,o(s)},handleClose:()=>{$.value=!1},isDrawerVisible:$,dataIdOrder:O,giveOrder:d,doneOrder:N,searchKeyword:k,onSearch:L}}}),ne={class:"row mb-3"},re={class:"col-6"},le=e("div",{class:"col-6 d-flex justify-content-end"},null,-1),ce={class:"row mb-3"},ie={class:"col-12"},de={class:"row"},he={class:"col-12"},ue={key:0},pe=["src","alt"],me={key:2},ge={key:3},_e={key:4},ye={key:5},fe=e("i",{class:"fa-solid fa-eye"},null,-1),ve={class:"col-12"},ke={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},be=e("p",null,"Tên sản phẩm :",-1),we={style:{color:"black"}},$e={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},Ie=e("p",null,"Tên cửa hàng :",-1),Se={style:{color:"black"}},Ne={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},Ce=e("p",null,"Tên khách hàng :",-1),Oe={style:{color:"black"}},Pe={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},De=e("p",null,"Số lượng sản phẩm :",-1),Be={style:{color:"black"}},Te={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},ze=e("p",null,"Tổng tiền :",-1),Ae={style:{color:"black"}},Ve={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},Fe=e("p",null,"Số điện thoại khách hàng :",-1),xe={style:{color:"black"}},Ee={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},Ke=e("p",null,"Ngày đặt hàng :",-1),Le={style:{color:"black"}},Ue={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},Me={style:{color:"black"}};function Re(a,i,z,A,$,O){const I=l("a-breadcrumb-item"),_=l("a-breadcrumb"),S=l("a-input"),v=l("a-form-item"),k=l("a-button"),n=l("a-form"),P=l("a-table"),D=l("a-pagination"),p=l("a-card"),B=l("a-drawer");return g(),y(Z,null,[c(p,{style:{width:"100%"}},{default:h(()=>[e("div",ne,[e("div",re,[c(_,null,{default:h(()=>[c(I,null,{default:h(()=>[x("Danh sách đơn hàng cửa hàng")]),_:1})]),_:1})]),le]),e("div",ce,[e("div",ie,[c(n,{onSubmit:ee(a.onSearch,["prevent"])},{default:h(()=>[c(v,null,{default:h(()=>[c(S,{placeholder:"Tìm kiếm sản phẩm",value:a.searchKeyword,"onUpdate:value":i[0]||(i[0]=o=>a.searchKeyword=o),onPressEnter:a.onSearch},null,8,["value","onPressEnter"])]),_:1}),c(k,{type:"primary",onClick:a.onSearch},{default:h(()=>[x("Tìm kiếm")]),_:1},8,["onClick"])]),_:1},8,["onSubmit"])])]),e("div",de,[e("div",he,[c(P,{dataSource:a.users,columns:a.columns,scroll:{x:576},pagination:!1},{bodyCell:h(({column:o,index:b,record:d})=>{var N;return[o.key==="index"?(g(),y("span",ue,r(b+1),1)):f("",!0),o.key==="imageSp"?(g(),y("img",{key:1,style:{width:"50px !important"},src:d.productImg,alt:d.productImg},null,8,pe)):f("",!0),o.key==="userName"?(g(),y("span",me,r(d.productName),1)):f("",!0),o.key==="fullName"?(g(),y("span",ge,r(d.quantity),1)):f("",!0),o.key==="email"?(g(),y("span",_e,r((N=d.priceTotal)==null?void 0:N.toLocaleString())+" VNĐ",1)):f("",!0),o.key==="status"?(g(),y("span",ye,r(d.orderStatusName),1)):f("",!0),o.key==="action"&&a.authStoreClaim!==null?(g(),te(k,{key:6,onClick:V=>a.showDrawer(d.orderDetailId),title:"Xem",type:"dashed",size:"small",shape:"",blue:""},{default:h(()=>[fe]),_:2},1032,["onClick"])):f("",!0)]}),_:1},8,["dataSource","columns"]),e("div",ve,[c(D,{onChange:a.onChange,current:a.pageParam.currentPage,"onUpdate:current":i[1]||(i[1]=o=>a.pageParam.currentPage=o),total:a.pageParam.totalItems,pageSize:a.pageParam.pageSize,"show-total":(o,b)=>`${b[0]}-${b[1]} của ${o} sản phẩm`,class:"mt-2 text-end"},null,8,["onChange","current","total","pageSize","show-total"])])])])]),_:1}),e("div",null,[c(B,{title:"Chi tiết đơn hàng ",visible:a.isDrawerVisible,width:850,onClose:a.handleClose,destroyOnClose:!0},{default:h(()=>{var o;return[e("div",ke,[be,e("p",we,r(a.dataIdOrder.productName),1)]),e("div",$e,[Ie,e("p",Se,r(a.dataIdOrder.storeName),1)]),e("div",Ne,[Ce,e("p",Oe,r(a.dataIdOrder.customerName),1)]),e("div",Pe,[De,e("p",Be,r(a.dataIdOrder.quantity),1)]),e("div",Te,[ze,e("p",Ae,r((o=a.dataIdOrder.priceTotal)==null?void 0:o.toLocaleString())+" VND ",1)]),e("div",Ve,[Fe,e("p",xe,r(a.dataIdOrder.customerPhone),1)]),e("div",Ee,[Ke,e("p",Le,r(a.formatDate(a.dataIdOrder.createdAt)),1)]),e("div",Ue,[e("p",null,r(a.getOrderStatusLabel(a.dataIdOrder.orderStatusId))+" : ",1),e("p",Me,r(a.formatDate(a.dataIdOrder.updatedAt)),1)])]}),_:1},8,["visible","onClose"])])],64)}const He=se(oe,[["render",Re]]);export{He as default};
