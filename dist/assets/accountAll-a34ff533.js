import{d as G,r as h,u as H,v as J,a as W,x as Y,o as j,b as l,e as _,z as U,w as t,q as V,y as $,g as m,h as o,j as S,i as q,f as P,t as z,l as f,F as L,p as x,k as Q}from"./index-64ce397b.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";const Z=G({setup(){const e=h(H().user.roleClaimDetail);J();const r=W(),C="http://localhost:9000",B=JSON.parse(localStorage.getItem("token")),A=JSON.parse(localStorage.getItem("auth")).role,M=h(r.params.id),y=h([]),p=h(""),i=h("MANAGER"),a=Y({currentPage:1,pageSize:10,totalItems:0,totalPages:0}),w=h(!1),u=h(""),b=h(),N=[{title:"#",key:"index"},{title:"Email",key:"email"},{title:"Họ",key:"firstname"},{title:"Tên",key:"lastname"},{title:"Tác vụ",key:A,fixed:"right"}],R=n=>{b.value=n},K=()=>{console.log(b.value),console.log(u.value),u.value?(I(b.value,u.value),w.value=!1,u.value=""):console.error("Lý do không được để trống")},g=(n,c,v="",F)=>{V.get(`${C}/api/v1/admin/account/view`,{headers:{Authorization:`Bearer ${B}`},params:{page:n,size:c,keyword:v,role:F}}).then(E=>{const D=E.data;y.value=D.data,console.log(y.value),a.totalItems=D.pagination.totalItems,a.totalPages=D.pagination.totalPages}).catch(E=>{console.error(E)})},I=n=>{const c=new FormData;c.append("accountId",n),V.post(`${C}/api/v1/admin/account/ban`,c,{headers:{Authorization:`Bearer ${B}`}}).then(v=>{$.success("Khóa thành công!"),g(a.currentPage,a.pageSize,p.value,i.value)}).catch(v=>{$.error("Khóa không thành công!"),console.error(v)})},s=n=>{const c=new FormData;c.append("accountId",n),V.post(`${C}/api/v1/admin/account/active`,c,{headers:{Authorization:`Bearer ${B}`}}).then(v=>{$.success("Mở khóa thành công!"),g(a.currentPage,a.pageSize,p.value,i.value)}).catch(v=>{$.error("Mở khóa không thành công!"),console.error(v)})},k=(n,c)=>{a.currentPage=n,a.pageSize=c,g(n,c,p.value,i.value)},d=()=>{a.currentPage=1,g(a.currentPage,a.pageSize,p.value,i.value)};return j(()=>{g(a.currentPage,a.pageSize,i.value)}),{authStoreClaim:e,users:y,columns:N,pageParam:a,storeId2:M,searchKeyword:p,onChange:k,onSearch:d,role:A,confirmUnBan:s,confirmBan:I,handleBanConfirm:K,showBanModal:R,isBanModalVisible:w,banReason:u,selectedRole:i}}}),O=e=>(x("data-v-9e352304"),e=e(),Q(),e),ee={class:"row mb-3"},ae={class:"col-6"},te={class:"row mb-3"},oe={class:"col-12"},ne={class:"row"},se={class:"col-12"},le={key:0},re={key:1},ce={key:2},ie={key:3},ue=O(()=>m("p",{class:"me-2 text-danger"},"Khóa",-1)),de=O(()=>m("p",{class:"me-2 text-green"},"Mở",-1)),me={class:"col-12"};function pe(e,r,C,B,T,A){const M=l("a-breadcrumb-item"),y=l("a-breadcrumb"),p=l("a-input"),i=l("a-form-item"),a=l("a-select-option"),w=l("a-select"),u=l("a-button"),b=l("a-form"),N=l("a-popconfirm"),R=l("a-modal"),K=l("a-table"),g=l("a-pagination"),I=l("a-card");return _(),U(I,{style:{width:"100%"}},{default:t(()=>[m("div",ee,[m("div",ae,[o(y,null,{default:t(()=>[o(M,null,{default:t(()=>[S("Danh sách các tài khoản")]),_:1})]),_:1})])]),m("div",te,[m("div",oe,[o(b,{onSubmit:q(e.onSearch,["prevent"])},{default:t(()=>[o(i,null,{default:t(()=>[o(p,{placeholder:"Tìm kiếm tài khoản",value:e.searchKeyword,"onUpdate:value":r[0]||(r[0]=s=>e.searchKeyword=s),onPressEnter:e.onSearch},null,8,["value","onPressEnter"])]),_:1}),o(i,null,{default:t(()=>[o(w,{value:e.selectedRole,"onUpdate:value":r[1]||(r[1]=s=>e.selectedRole=s),placeholder:"Chọn loại tài khoản","default-value":"MANAGER"},{default:t(()=>[o(a,{value:"MANAGER"},{default:t(()=>[S("Chủ cửa hàng")]),_:1}),o(a,{value:"SHIPPER"},{default:t(()=>[S("Người giao hàng")]),_:1}),o(a,{value:"USER"},{default:t(()=>[S("Khách hàng")]),_:1})]),_:1},8,["value"])]),_:1}),o(u,{type:"primary",onClick:e.onSearch},{default:t(()=>[S("Tìm kiếm")]),_:1},8,["onClick"])]),_:1},8,["onSubmit"])])]),m("div",ne,[m("div",se,[o(K,{dataSource:e.users,columns:e.columns,scroll:{x:576},pagination:!1},{bodyCell:t(({column:s,index:k,record:d})=>[s.key==="index"?(_(),P("span",le,z(k+1),1)):f("",!0),s.key==="email"?(_(),P("span",re,z(d.email),1)):f("",!0),s.key==="firstname"?(_(),P("span",ce,z(d.firstname),1)):f("",!0),s.key==="lastname"?(_(),P("span",ie,z(d.lastname),1)):f("",!0),s.key==="ADMIN"&&e.authStoreClaim!==null?(_(),P(L,{key:4},[d.enabled?(_(),U(N,{key:0,title:"Bạn có muốn khóa tài khoản?","ok-text":"Yes","cancel-text":"No",onConfirm:n=>e.confirmBan(d.id)},{default:t(()=>[o(u,{title:"Khóa sản phẩm",type:"dashed",size:"small",shape:""},{default:t(()=>[ue]),_:1})]),_:2},1032,["onConfirm"])):f("",!0),d.enabled?f("",!0):(_(),U(N,{key:1,title:"Bạn có muốn mở khóa tài khoản?","ok-text":"Yes","cancel-text":"No",onConfirm:n=>e.confirmUnBan(d.id)},{default:t(()=>[o(u,{title:"Khóa sản phẩm",type:"dashed",size:"small",shape:""},{default:t(()=>[de]),_:1})]),_:2},1032,["onConfirm"])),o(R,{visible:e.isBanModalVisible,"onUpdate:visible":r[3]||(r[3]=n=>e.isBanModalVisible=n),title:"Nhập lý do khóa sản phẩm","ok-text":"Khóa","cancel-text":"Hủy",onOk:e.handleBanConfirm},{default:t(()=>[o(p,{value:e.banReason,"onUpdate:value":r[2]||(r[2]=n=>e.banReason=n),placeholder:"Nhập lý do"},null,8,["value"])]),_:1},8,["visible","onOk"])],64)):f("",!0)]),_:1},8,["dataSource","columns"]),m("div",me,[o(g,{onChange:e.onChange,current:e.pageParam.currentPage,"onUpdate:current":r[4]||(r[4]=s=>e.pageParam.currentPage=s),total:e.pageParam.totalItems,pageSize:e.pageParam.pageSize,"show-total":(s,k)=>`${k[0]}-${k[1]} của ${s} sản phẩm`,class:"mt-2 text-end"},null,8,["onChange","current","total","pageSize","show-total"])])])])]),_:1})}const ge=X(Z,[["render",pe],["__scopeId","data-v-9e352304"]]);export{ge as default};
