import{d as F,R as E,D as R,B as H,S as G,a as y,q as J,U as L,s as Q,r as j,t as W,x as u,y as d,z as c,b as l,F as m,N as A,Q as I,V as P,C as s,I as $,G as X,E as o,M as h}from"./index-cdcf547c.js";import{u as Y}from"./use-menu-b48628b9.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";const x=F({components:{"a-form":E,"a-form-item":E.Item,"a-drawer":R,"a-button":H,"a-input-number":G},setup(){Y().onSelectedKeys(["admin-users"]);const e=y(J().user.roleClaimDetail),p="http://localhost:9000",N=L(),V=Q(),O=y([]),D=y([]),k=y({}),f=y(""),n=j({currentPage:1,pageSize:10,totalItems:0,totalPages:0}),v=y(!1),g=JSON.parse(localStorage.getItem("token")),b=()=>{v.value=!0},z=()=>{v.value=!1},T=async i=>{b();const{data:t}=await I.get(`${p}/api/v1/shipper/orderdetail?orderid=${i}`,{headers:{Authorization:`Bearer ${g}`}});t.status==="OK"?(k.value=t.data,console.log(k.data,"dataId.data")):console.error(t.message)},B=[{title:"#",key:"index"},{title:"Tên cửa hàng",dataIndex:"userName",key:"userName"},{title:"Tên sản phẩm",dataIndex:"fullName",key:"fullName"},{title:"Số lượng",key:"email"},{title:"Đia chỉ cửa hàng",key:"email2"},{title:"Số cửa hàng",key:"email5"},{title:"Ảnh",key:"email3"},{title:"Tổng tiền",key:"email4"},{title:"Tác vụ",key:"action",fixed:"right"}],S=(i,t,M="")=>{I.get(`${p}/api/v1/shipper/orderlist/taken`,{params:{page:i,size:t,keyword:M},headers:{Authorization:`Bearer ${g}`}}).then(C=>{const K=C.data.data.sort((U,q)=>new Date(q.updateAt)-new Date(U.updateAt));console.log(K,"response"),D.value=K,n.totalItems=C.data.pagination.totalItems,n.totalPages=C.data.pagination.totalPages}).catch(C=>{console.error(C)})},a=(i,t)=>{n.currentPage=i,n.pageSize=t,S(i,t,f.value)},_=async i=>{try{const t=await I.get(`${p}/api/v1/shipper/changestatus1/${i}`,{headers:{Authorization:`Bearer ${g}`}});P.success("success")}catch(t){P.error(t.response.data.message)}},r=()=>{n.currentPage=1,S(n.currentPage,n.pageSize,f.value)},w=async i=>{try{const t=await I.get(`${p}/api/v1/shipper/changestatus2/${i}`,{headers:{Authorization:`Bearer ${g}`}});N.push("danh-sach-don-da-giao"),P.success("success")}catch(t){P.error(t.response.data.message)}};return W(()=>{S(n.currentPage,n.pageSize)}),{route:V,onSearch:r,searchKeyword:f,router:N,authStoreClaim:e,errors:O,users:D,columns:B,pageParam:n,onChange:a,giveOrder:_,doneOrder:w,isDrawerVisible:v,showDrawer:b,handleClose:z,dataId:k,getIdDh:T}}}),ee={class:"row mb-3"},ae={class:"col-6"},te={class:"row"},se={class:"row mb-3"},oe={class:"col-12"},ne={class:"col-12"},re={key:0},ie={key:1},le={key:2},de={key:3},ce={key:4},ue={key:5},me=["src","alt"],he={key:7},pe={class:"col-12"},ge={class:"giohang orderhome"},_e={style:{color:"black"}};function ye(e,p,N,V,O,D){const k=u("a-breadcrumb-item"),f=u("a-breadcrumb"),n=u("a-input"),v=u("a-form-item"),g=u("a-button"),b=u("a-form"),z=u("a-table"),T=u("a-pagination"),B=u("a-card"),S=u("a-drawer");return d(),c(A,null,[l(B,{style:{width:"100%"}},{default:m(()=>[s("div",ee,[s("div",ae,[l(f,null,{default:m(()=>[l(k,null,{default:m(()=>[$("Danh sách đơn đã nhận")]),_:1})]),_:1})])]),s("div",te,[s("div",se,[s("div",oe,[l(b,{onSubmit:X(e.onSearch,["prevent"])},{default:m(()=>[l(v,null,{default:m(()=>[l(n,{placeholder:"Tìm kiếm",value:e.searchKeyword,"onUpdate:value":p[0]||(p[0]=a=>e.searchKeyword=a),onPressEnter:e.onSearch},null,8,["value","onPressEnter"])]),_:1}),l(g,{type:"primary",onClick:e.onSearch},{default:m(()=>[$("Tìm kiếm")]),_:1},8,["onClick"])]),_:1},8,["onSubmit"])])]),s("div",ne,[l(z,{dataSource:e.users,columns:e.columns,scroll:{x:576},pagination:!1},{bodyCell:m(({column:a,index:_,record:r})=>{var w;return[a.key==="index"?(d(),c("span",re,o(_+1+(e.pageParam.currentPage-1)*10),1)):h("",!0),a.key==="userName"?(d(),c("span",ie,o(r.storeName),1)):h("",!0),a.key==="fullName"?(d(),c("span",le,o(r.productName),1)):h("",!0),a.key==="email"?(d(),c("span",de,o(r.quantity),1)):h("",!0),a.key==="email2"?(d(),c("span",ce,o(r.storeAddress),1)):h("",!0),a.key==="email5"?(d(),c("span",ue,o(r.storePhone),1)):h("",!0),a.key==="email3"?(d(),c("img",{key:6,style:{width:"50px !important"},src:r.productImg,alt:r.productImg},null,8,me)):h("",!0),a.key==="email4"?(d(),c("span",he,o((w=r.priceTotal)==null?void 0:w.toLocaleString())+" VND",1)):h("",!0),a.key==="action"&&e.authStoreClaim!==null?(d(),c(A,{key:8},[],64)):h("",!0),a.key==="action"&&e.authStoreClaim!==null?(d(),c(A,{key:9},[l(g,{onClick:i=>e.getIdDh(r.orderDetailId),type:"dashed",size:"small"},{default:m(()=>[$(" Chi tiết ")]),_:2},1032,["onClick"]),l(g,{title:"Hoàn thành đơn",onClick:i=>e.doneOrder(r.orderDetailId),type:"dashed",size:"small",shape:""},{default:m(()=>[$(" Hoàn thành ")]),_:2},1032,["onClick"])],64)):h("",!0)]}),_:1},8,["dataSource","columns"]),s("div",pe,[l(T,{onChange:e.onChange,current:e.pageParam.currentPage,"onUpdate:current":p[1]||(p[1]=a=>e.pageParam.currentPage=a),total:e.pageParam.totalItems,pageSize:e.pageParam.pageSize,"show-total":(a,_)=>`${_[0]}-${_[1]} của ${a} đơn hàng`,class:"mt-2 text-end"},null,8,["onChange","current","total","pageSize","show-total"])])])])]),_:1}),l(S,{title:"Chi tiết",visible:e.isDrawerVisible,width:850,onClose:e.handleClose,destroyOnClose:!0},{default:m(()=>[s("div",ge,[s("p",_e,"Tên khách hàng : "+o(e.dataId.customerName),1),s("p",null,"Số điện thoại : "+o(e.dataId.customerPhone),1),s("p",null,"Tổng tiền :"+o(e.dataId.priceTotal),1),s("p",null,"Tên sản phẩm :"+o(e.dataId.productName),1),s("p",null,"Số lượng :"+o(e.dataId.quantity),1),s("p",null,"Địa chỉ giao hàng:"+o(e.dataId.address),1)])]),_:1},8,["visible","onClose"])],64)}const Se=Z(x,[["render",ye]]);export{Se as default};
