import{d as A,r as S,u as D,v as U,a as V,x,o as E,b as c,e as u,z as F,w as n,q as M,y as g,g as l,h as r,j as N,i as R,f,t as y,l as h}from"./index-64ce397b.js";import{u as X}from"./use-menu-6afec9f3.js";import{A as K}from"./ApiUser-37b3c88e.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";const J=A({setup(){X().onSelectedKeys(["admin-users"]);const a="http://localhost:9000",d=S(D().user.roleClaimDetail),B=U(),$=V(),z=JSON.parse(localStorage.getItem("auth")).storeId,m=S([]),k=S([]),p=S(""),t=x({currentPage:1,pageSize:10,totalItems:0,totalPages:0}),v=[{title:"#",key:"index"},{title:"Tên khách hàng",dataIndex:"userName",key:"userName"},{title:"Số điện thoại",dataIndex:"fullName",key:"fullName"},{title:"Số lượng đơn hàng",key:"email"},{title:"Tổng chi",key:"totalPayment"},{title:"Tác vụ",key:"action",fixed:"right"}],P=JSON.parse(localStorage.getItem("token")),i=(s,e,O="")=>{M.get(`${a}/api/v1/management/${z}/customer/view`,{headers:{Authorization:`Bearer ${P}`},params:{page:s,size:e,keyword:O}}).then(_=>{console.log(_.data.data,"response");const T=_.data;k.value=_.data.data,t.totalItems=T.pagination.totalItems,t.totalPages=T.pagination.totalPages}).catch(_=>{console.error(_)})},b=(s,e)=>{t.currentPage=s,t.pageSize=e,i(s,e,p.value)},w=()=>{t.currentPage=1,i(t.currentPage,t.pageSize,p.value)},C=s=>{K.DeleteById(s).then(e=>{console.log(e),e.status==200&&g.success("Xóa thành công!"),i(t)}).catch(e=>{g.error(e.message),e.response.data.hasOwnProperty("errors")?m.value=e.response.data.errors:m.value=e.response.data})},I=s=>{K.BannedById(s).then(e=>{e.status==200?g.success("Khóa thành công!"):g.error("Lỗi! Tác vụ thực hiện không thành công."),i(t)}).catch(e=>{g.error(e.message),e.response.data.hasOwnProperty("errors")?m.value=e.response.data.errors:m.value=e.response.data})};return E(()=>{i(t.currentPage,t.pageSize)}),{route:$,router:B,authStoreClaim:d,errors:m,users:k,columns:v,pageParam:t,onChange:b,clickFrmFilter:s=>{t.statusFilter=!0,i(t)},confirmRemove:C,confirmBanned:I,searchKeyword:p,onSearch:w}}}),q={class:"row mb-3"},L={class:"col-6"},G={class:"col-6 d-flex justify-content-end"},H=l("i",{class:"fa-solid fa-vials"},null,-1),Q=l("i",{class:"fa-solid fa-vial-virus"},null,-1),W=l("i",{class:"fa-solid fa-plus"},null,-1),Y={class:"row mb-3"},Z={class:"col-12"},ee={class:"row"},te={class:"col-12"},ae={key:0},se={key:1},oe={key:2},ne={key:3},re={key:4},le={class:"col-12"};function ce(a,d,B,$,z,m){const k=c("a-breadcrumb-item"),p=c("a-breadcrumb"),t=c("a-button"),v=c("router-link"),P=c("a-input"),i=c("a-form-item"),b=c("a-form"),w=c("a-table"),C=c("a-pagination"),I=c("a-card");return u(),F(I,{style:{width:"100%"}},{default:n(()=>[l("div",q,[l("div",L,[r(p,null,{default:n(()=>[r(k,null,{default:n(()=>[N("Danh sách khách hàng cửa hàng")]),_:1})]),_:1})]),l("div",G,[r(t,{class:"me-2"},{default:n(()=>[H]),_:1}),r(t,{class:"me-2"},{default:n(()=>[Q]),_:1}),r(t,{type:"primary",title:"Thêm mới"},{default:n(()=>[r(v,{to:{name:"admin-store-create"}},{default:n(()=>[W]),_:1})]),_:1})])]),l("div",Y,[l("div",Z,[r(b,{onSubmit:R(a.onSearch,["prevent"])},{default:n(()=>[r(i,null,{default:n(()=>[r(P,{placeholder:"Tìm kiếm",value:a.searchKeyword,"onUpdate:value":d[0]||(d[0]=o=>a.searchKeyword=o),onPressEnter:a.onSearch},null,8,["value","onPressEnter"])]),_:1}),r(t,{type:"primary",onClick:a.onSearch},{default:n(()=>[N("Tìm kiếm")]),_:1},8,["onClick"])]),_:1},8,["onSubmit"])])]),l("div",ee,[l("div",te,[r(w,{dataSource:a.users,columns:a.columns,scroll:{x:576},pagination:!1},{bodyCell:n(({column:o,index:s,record:e})=>[o.key==="index"?(u(),f("span",ae,y(s+1),1)):h("",!0),o.key==="userName"?(u(),f("span",se,y(e.customerName),1)):h("",!0),o.key==="fullName"?(u(),f("span",oe,y(e.customerPhoneNumber),1)):h("",!0),o.key==="email"?(u(),f("span",ne,y(e.totalOrder),1)):h("",!0),o.key==="totalPayment"?(u(),f("span",re,y(e.totalPayment),1)):h("",!0),o.key==="action"&&a.authStoreClaim!==null?(u(),F(v,{key:5,to:{name:"order-by-user",params:{id:e.storeId,customerId:e.customerId}}},{default:n(()=>[r(t,{title:"Xóa",type:"dashed",size:"small",shape:"",danger:""},{default:n(()=>[N(" Xem đơn đã mua ")]),_:1})]),_:2},1032,["to"])):h("",!0)]),_:1},8,["dataSource","columns"]),l("div",le,[r(C,{onChange:a.onChange,current:a.pageParam.currentPage,"onUpdate:current":d[1]||(d[1]=o=>a.pageParam.currentPage=o),total:a.pageParam.totalItems,pageSize:a.pageParam.pageSize,"show-total":(o,s)=>`${s[0]}-${s[1]} của ${o} sản phẩm`,class:"mt-2 text-end"},null,8,["onChange","current","total","pageSize","show-total"])])])])]),_:1})}const he=j(J,[["render",ce]]);export{he as default};
