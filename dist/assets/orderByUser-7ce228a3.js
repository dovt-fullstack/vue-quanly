import{d as E,r as p,u as J,v as M,a as R,x as j,o as q,b as l,e as m,f as g,h as i,w as d,g as e,F as L,q as x,y as S,j as F,i as X,t as c,l as y,z as G}from"./index-64ce397b.js";import{u as H}from"./use-menu-6afec9f3.js";import{A as V}from"./ApiUser-37b3c88e.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";const W=E({setup(){H().onSelectedKeys(["admin-users"]);const t=p(J().user.roleClaimDetail),h="http://localhost:9000",B=M(),P=R(),_=p([]),C=p([]),f=JSON.parse(localStorage.getItem("auth")).storeId;console.log(f,"storeId"),JSON.parse(localStorage.getItem("auth")).storeId;const N=p(P.params.customerId),v=p(!1),b=p({}),I=async n=>{const{data:a}=await x.get(`${h}/api/v1/management/${f}/orderdetail/view/${n}`,{headers:{Authorization:`Bearer ${s}`}});console.log(a,"ccd"),b.value=a.data},$=n=>{v.value=!0,I(n)},O=()=>{v.value=!1},k=p(""),o=j({currentPage:1,pageSize:10,totalItems:0,totalPages:0}),T=[{title:"#",key:"index"},{title:"Ảnh sản phẩm",dataIndex:"imageSp",key:"imageSp"},{title:"Tên sản phẩm",dataIndex:"fullName",key:"fullName"},{title:"Đơn giá",key:"totalPrice"},{title:"Trạng thái",dataIndex:"status",key:"status"},{title:"Tác vụ",key:"action",fixed:"right"}],s=JSON.parse(localStorage.getItem("token")),r=(n,a,U="")=>{x.get(`${h}/api/v1/management/${f}/customer/${N._value}/detail`,{headers:{Authorization:`Bearer ${s}`},params:{page:n,size:a,keyword:U}}).then(w=>{const D=w.data;C.value=w.data.data,o.totalItems=D.pagination.totalItems,o.totalPages=D.pagination.totalPages}).catch(w=>{console.error(w)})},u=n=>{V.DeleteById(n).then(a=>{console.log(a),a.status==200&&S.success("Xóa thành công!"),r(o)}).catch(a=>{S.error(a.message),a.response.data.hasOwnProperty("errors")?_.value=a.response.data.errors:_.value=a.response.data})},z=n=>{V.BannedById(n).then(a=>{a.status==200?S.success("Khóa thành công!"):S.error("Lỗi! Tác vụ thực hiện không thành công."),r(o)}).catch(a=>{S.error(a.message),a.response.data.hasOwnProperty("errors")?_.value=a.response.data.errors:_.value=a.response.data})},A=(n,a)=>{o.currentPage=n,o.pageSize=a,r(n,a,k.value)},K=()=>{o.currentPage=1,r(o.currentPage,o.pageSize,k.value)};return q(()=>{r(o.currentPage,o.pageSize)}),{route:P,router:B,authStoreClaim:t,errors:_,users:C,columns:T,pageParam:o,handleClose:O,showDrawer:$,onChange:A,clickFrmFilter:n=>{o.statusFilter=!0,r(o)},confirmRemove:u,confirmBanned:z,searchKeyword:k,isDrawerVisible:v,dataIdOrder:b,onSearch:K}}}),Y={class:"row mb-3"},Z={class:"col-6"},ee=e("div",{class:"col-6 d-flex justify-content-end"},null,-1),te={class:"row mb-3"},ae={class:"col-12"},se={class:"row"},oe={class:"col-12"},ne={key:0},re=["src","alt"],le={key:2},ie={key:3},ce={key:4},de=e("i",{class:"fa-solid fa-eye"},null,-1),ue={class:"col-12"},he={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},pe=e("p",null,"Tên sản phẩm :",-1),me={style:{color:"black"}},_e={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},ge=e("p",null,"Tên cửa hàng :",-1),ye={style:{color:"black"}},fe={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},ve=e("p",null,"Tên khách hàng :",-1),ke={style:{color:"black"}},Se={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},be=e("p",null,"Số lượng sản phẩm :",-1),Ie={style:{color:"black"}},we={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},Pe=e("p",null,"Tổng tiền :",-1),Ce={style:{color:"black"}},Ne={style:{display:"flex",gap:"10px"},class:"giohang orderhome"},$e=e("p",null,"Số điện thoại khách hàng :",-1),Oe={style:{color:"black"}};function Te(t,h,B,P,_,C){const f=l("a-breadcrumb-item"),N=l("a-breadcrumb"),v=l("a-input"),b=l("a-form-item"),I=l("a-button"),$=l("a-form"),O=l("a-table"),k=l("a-pagination"),o=l("a-card"),T=l("a-drawer");return m(),g(L,null,[i(o,{style:{width:"100%"}},{default:d(()=>[e("div",Y,[e("div",Z,[i(N,null,{default:d(()=>[i(f,null,{default:d(()=>[F("Sản phẩm khách đã mua")]),_:1})]),_:1})]),ee]),e("div",te,[e("div",ae,[i($,{onSubmit:X(t.onSearch,["prevent"])},{default:d(()=>[i(b,null,{default:d(()=>[i(v,{placeholder:"Tìm kiếm sản phẩm",value:t.searchKeyword,"onUpdate:value":h[0]||(h[0]=s=>t.searchKeyword=s),onPressEnter:t.onSearch},null,8,["value","onPressEnter"])]),_:1}),i(I,{type:"primary",onClick:t.onSearch},{default:d(()=>[F("Tìm kiếm")]),_:1},8,["onClick"])]),_:1},8,["onSubmit"])])]),e("div",se,[e("div",oe,[i(O,{dataSource:t.users,columns:t.columns,scroll:{x:576},pagination:!1},{bodyCell:d(({column:s,index:r,record:u})=>[s.key==="index"?(m(),g("span",ne,c(r+1),1)):y("",!0),s.key==="imageSp"?(m(),g("img",{key:1,style:{width:"50px !important"},src:u.productImg,alt:u.productImg},null,8,re)):y("",!0),s.key==="fullName"?(m(),g("span",le,c(u.productName),1)):y("",!0),s.key==="totalPrice"?(m(),g("span",ie,c(u.priceTotal),1)):y("",!0),s.key==="status"?(m(),g("span",ce,c(u.orderStatusName),1)):y("",!0),s.key==="action"&&t.authStoreClaim!==null?(m(),G(I,{key:5,onClick:z=>t.showDrawer(u.orderDetailId),title:"Xem",type:"dashed",size:"small",shape:"",blue:""},{default:d(()=>[de]),_:2},1032,["onClick"])):y("",!0)]),_:1},8,["dataSource","columns"]),e("div",ue,[i(k,{onChange:t.onChange,current:t.pageParam.currentPage,"onUpdate:current":h[1]||(h[1]=s=>t.pageParam.currentPage=s),total:t.pageParam.totalItems,pageSize:t.pageParam.pageSize,"show-total":(s,r)=>`${r[0]}-${r[1]} của ${s} sản phẩm`,class:"mt-2 text-end"},null,8,["onChange","current","total","pageSize","show-total"])])])])]),_:1}),e("div",null,[i(T,{title:"Chi tiết đơn hàng ",visible:t.isDrawerVisible,width:850,onClose:t.handleClose,destroyOnClose:!0},{default:d(()=>{var s;return[e("div",he,[pe,e("p",me,c(t.dataIdOrder.productName),1)]),e("div",_e,[ge,e("p",ye,c(t.dataIdOrder.storeName),1)]),e("div",fe,[ve,e("p",ke,c(t.dataIdOrder.customerName),1)]),e("div",Se,[be,e("p",Ie,c(t.dataIdOrder.quantity),1)]),e("div",we,[Pe,e("p",Ce,c((s=t.dataIdOrder.priceTotal)==null?void 0:s.toLocaleString())+" VND ",1)]),e("div",Ne,[$e,e("p",Oe,c(t.dataIdOrder.customerPhone),1)])]}),_:1},8,["visible","onClose"])])],64)}const Ve=Q(W,[["render",Te]]);export{Ve as default};
