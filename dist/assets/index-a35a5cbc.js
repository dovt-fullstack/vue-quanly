import{d as $,a as P,q as x,U as R,s as I,r as K,Y as V,t as A,x as u,y as p,W as N,F as a,V as y,C as l,b as s,I as F,Z as D,z as b,E as v,M as f,N as E}from"./index-cdcf547c.js";import{u as L}from"./use-menu-b48628b9.js";import{A as w}from"./ApiUser-6badb945.js";import{_ as M}from"./_plugin-vue_export-helper-c27b6911.js";const Y=$({setup(){L().onSelectedKeys(["admin-users"]);const n=P(x().user.roleClaimDetail),i=R(),o=I(),g=P([]),S=P([]),e=K({current:Object.keys(o.query).length>0?o.query.PageNumber:1,pageNumber:Object.keys(o.query).length>0?o.query.PageNumber:1,pageSize:Object.keys(o.query).length>0?o.query.PageSize:10,totalRecord:0,userName:Object.keys(o.query).length>0?o.query.UserName:"",statusFilter:!1}),h=[{title:"#",key:"index"},{title:"Tài khoản",dataIndex:"userName",key:"userName"},{title:"Họ tên",dataIndex:"fullName",key:"fullName"},{title:"Email",key:"email"},{title:"Tác vụ",key:"action",fixed:"right"}],c=m=>{w.GetAllByLimit(m).then(t=>{S.value=t.data.data,e.current=t.data.pageNumber,e.pageNumber=t.data.pageNumber,e.pageSize=t.data.pageSize,e.totalRecord=t.data.totalRecords,e.userName=m.userName,e.statusFilter&&(t.data.totalPages<t.data.pageNumber&&t.data.totalRecords>0?(e.current=1,e.pageNumber=1,c(e),i.push({name:"admin-users",query:{PageNumber:1,PageSize:e.pageSize,UserName:e.userName}})):i.push({name:"admin-users",query:{PageNumber:e.pageNumber,PageSize:e.pageSize,UserName:e.userName}}))}).catch(t=>{y.error(`Lỗi! ${t.response.statusText}`)})},C=m=>{w.DeleteById(m).then(t=>{console.log(t),t.status==200&&y.success("Xóa thành công!"),c(e)}).catch(t=>{y.error(t.message),t.response.data.hasOwnProperty("errors")?g.value=t.response.data.errors:g.value=t.response.data})},d=m=>{w.BannedById(m).then(t=>{t.status==200?y.success("Khóa thành công!"):y.error("Lỗi! Tác vụ thực hiện không thành công."),c(e)}).catch(t=>{y.error(t.message),t.response.data.hasOwnProperty("errors")?g.value=t.response.data.errors:g.value=t.response.data})};V(()=>{Object.keys(o.query).length===0&&(e.current=Object.keys(o.query).length>0?o.query.PageNumber:1,e.pageNumber=Object.keys(o.query).length>0?o.query.PageNumber:1,e.pageSize=Object.keys(o.query).length>0?o.query.PageSize:10,e.userName=Object.keys(o.query).length>0?o.query.UserName:"",e.statusFilter=!0,c(e))}),A(()=>{c(e)});function q(m,t){e.pageNumber=m,e.pageSize=t,e.statusFilter=!0,c(e)}return{route:o,router:i,authStoreClaim:n,errors:g,users:S,columns:h,pageParam:e,onChange:q,clickFrmFilter:m=>{e.statusFilter=!0,c(e)},confirmRemove:C,confirmBanned:d}}}),X={class:"row mb-3"},G={class:"col-6"},H={class:"col-6 d-flex justify-content-end"},W=l("i",{class:"fa-solid fa-vials"},null,-1),Z=l("i",{class:"fa-solid fa-vial-virus"},null,-1),J=l("i",{class:"fa-solid fa-plus"},null,-1),Q={class:"row"},ee={class:"col-12"},te={class:"col-3"},ae=l("label",{for:"exampleFormControlInput1",class:"form-label"},"Tài khoản",-1),se={class:"col-3"},ne=l("label",{for:"exampleFormControlInput1",class:"form-label"},".",-1),oe={class:"row"},le={class:"col-12"},re={key:0},ie={key:1},ue={key:2},me={key:3},ce=l("i",{class:"fa-solid fa-pen-to-square"},null,-1),de=l("i",{class:"fa-solid fa-lock"},null,-1),pe=l("i",{class:"fa-solid fa-trash-can"},null,-1),_e={class:"col-12"};function fe(n,i,o,g,S,e){const h=u("router-link"),c=u("a-breadcrumb-item"),C=u("a-breadcrumb"),d=u("a-button"),q=u("a-input"),z=u("a-form-item"),m=u("a-form"),t=u("a-space"),B=u("a-popconfirm"),O=u("a-table"),U=u("a-pagination"),j=u("a-card");return p(),N(j,{style:{width:"100%"}},{default:a(()=>[l("div",X,[l("div",G,[s(C,null,{default:a(()=>[s(c,null,{default:a(()=>[s(h,{to:{name:"admin-dashboards"}},{default:a(()=>[F("Trang chủ")]),_:1})]),_:1}),s(c,null,{default:a(()=>[F("Tài khoản")]),_:1})]),_:1})]),l("div",H,[s(d,{class:"me-2"},{default:a(()=>[s(h,{to:{name:"admin-users-test"}},{default:a(()=>[W]),_:1})]),_:1}),s(d,{class:"me-2"},{default:a(()=>[s(h,{to:{name:"admin-users-test2"}},{default:a(()=>[Z]),_:1})]),_:1}),s(d,{type:"primary",title:"Thêm mới"},{default:a(()=>[s(h,{to:{name:"admin-users-create"}},{default:a(()=>[J]),_:1})]),_:1})])]),l("div",Q,[l("div",ee,[s(m,{onKeyup:i[2]||(i[2]=D(r=>n.clickFrmFilter(r),["enter"])),layout:"inline",class:"p-3 border"},{default:a(()=>[l("div",te,[ae,s(z,null,{default:a(()=>[s(q,{value:n.pageParam.userName,"onUpdate:value":i[0]||(i[0]=r=>n.pageParam.userName=r),placeholder:"Username",class:"form-control form-control-sm",size:"small"},null,8,["value"])]),_:1})]),l("div",se,[ne,s(z,null,{default:a(()=>[s(d,{onClick:i[1]||(i[1]=r=>n.clickFrmFilter(r)),class:"bg-success text-light btn btn-sm",size:"small",type:"submit","html-type":"button"},{default:a(()=>[F(" Tìm kiếm ")]),_:1})]),_:1})])]),_:1})])]),l("div",oe,[l("div",le,[s(O,{dataSource:n.users,columns:n.columns,scroll:{x:576},pagination:!1},{bodyCell:a(({column:r,index:k,record:_})=>[r.key==="index"?(p(),b("span",re,v(k+1),1)):f("",!0),r.key==="userName"?(p(),b("span",ie,v(_.userName),1)):f("",!0),r.key==="fullName"?(p(),b("span",ue,v(_.fullName),1)):f("",!0),r.key==="email"?(p(),b("span",me,v(_.email),1)):f("",!0),r.key==="action"&&n.authStoreClaim!==null?(p(),b(E,{key:4},[n.authStoreClaim["admin.users.edit"]==="1"?(p(),N(t,{key:0,warp:""},{default:a(()=>[s(h,{to:{name:"admin-users-edit",params:{id:_.id}}},{default:a(()=>[s(d,{type:"dashed",class:"me-2 text-primary",size:"small",title:"Sửa"},{default:a(()=>[ce]),_:1})]),_:2},1032,["to"])]),_:2},1024)):f("",!0),n.authStoreClaim["admin.users.banned"]==="1"&&_.status!=-5?(p(),N(B,{key:1,title:"Bạn muốn Khóa bản ghi này?","ok-text":"Yes","cancel-text":"No",onConfirm:T=>n.confirmBanned(_.id)},{default:a(()=>[s(d,{title:"Khóa",type:"dashed",size:"small",shape:"",class:"me-2 text-warning"},{default:a(()=>[de]),_:1})]),_:2},1032,["onConfirm"])):f("",!0),n.authStoreClaim["admin.users.delete"]==="1"&&_.status==-5?(p(),N(B,{key:2,title:"Dữ liệu sẽ không thể phục hồi, bạn muốn xóa bản ghi này?","ok-text":"Yes","cancel-text":"No",onConfirm:T=>n.confirmRemove(_.id)},{default:a(()=>[s(d,{title:"Xóa",type:"dashed",size:"small",shape:"",danger:""},{default:a(()=>[pe]),_:1})]),_:2},1032,["onConfirm"])):f("",!0)],64)):f("",!0)]),_:1},8,["dataSource","columns"]),l("div",_e,[s(U,{onChange:n.onChange,current:n.pageParam.current,"onUpdate:current":i[3]||(i[3]=r=>n.pageParam.current=r),total:n.pageParam.totalRecord,pageSize:n.pageParam.pageSize,"show-total":(r,k)=>`${k[0]}-${k[1]} of ${r} items`,class:"mt-2 text-end"},null,8,["onChange","current","total","pageSize","show-total"])])])])]),_:1})}const ke=M(Y,[["render",fe]]);export{ke as default};
