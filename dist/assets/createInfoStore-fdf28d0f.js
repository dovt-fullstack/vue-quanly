import{d as Q,H as Y,r as c,u as W,v as X,x as N,o as Z,J as x,b as p,e as u,z as P,w as l,q as U,y as v,g as m,h as n,f as h,t as y,l as L,K as ee,j as T,F as ae,M as te}from"./index-64ce397b.js";import{u as oe}from"./use-menu-6afec9f3.js";import{A as F,B as se}from"./BaseCommon-86b03c47.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";const ne=Q({components:{DeleteOutlined:Y},setup(){oe().onSelectedKeys(["admin-users"]);const a=c(W().user.roleClaimDetail),s="http://localhost:9000";console.log(s),X();const b=JSON.parse(localStorage.getItem("token")),g=N({optionsLevelManage:[],optionsRole:[],optionsStatus:[]}),R=c({}),w=c(),o=N({storeTypeId:"",address:"",phonenumber:"",name:"",image:"",loading:!1,avatarProduct:"",avatarFile:null}),i=c(null),S=c(""),C=e=>{console.log(`selected ${e}`)},f=c([]),_={address:[{required:!0,message:"Địa chỉ không để trống.",trigger:"change"}],phonenumber:[{required:!0,message:"Điện thoại không để trống.",trigger:"change"}],name:[{required:!0,message:"Tên cửa hàng không để trống.",trigger:"change"}]},k=async()=>{try{console.log(13132223);const e=await U.get(` ${s}/api/v1/storetype/view`,{headers:{Authorization:`Bearer ${b}`}});e.data.status==="OK"?(console.log(e.data),f.value=e.data.data):console.error(e.data.message)}catch(e){console.error(e)}},r=e=>{const t=e.target.files[0];if(!t)return;if(!(t.type==="image/jpeg"||t.type==="image/png")){v.error("You can only upload JPG/PNG file!");return}if(!(t.size/1024/1024<2)){v.error("Image must smaller than 2MB!");return}const O=new FileReader;O.onloadend=()=>{S.value=O.result,i.value=t},O.readAsDataURL(t)},q=async()=>{const e=new FormData;o.loading=!0;try{if(o.name)e.append("name",o.name);else throw new Error("Store name is missing");if(o.address)e.append("address",o.address);else throw new Error("address is missing");if(o.phonenumber)e.append("phonenumber",o.phonenumber);else throw new Error("phonenumber is missing");e.append("storetypeid",o.storeTypeId),i.value?e.append("image",i.value):e.append("image",o.avatarProduct);for(let I of e.entries())console.log(I[0]+", "+I[1]);const t=await U.post(`${s}/api/v1/management/info/insert`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${b}`}});v.success("Thêm thông tin thành công!"),o.loading=!1,console.log(t.data.data),console.log(t.data);let d=localStorage.getItem("auth");d&&(d=JSON.parse(d),d.storeId=t.data.data.storeId,localStorage.setItem("auth",JSON.stringify(d))),window.location.href="/dashboards"}catch(t){console.error("Error during form submission:",t),t.response&&t.response.data&&t.response.data.message?v.error("Có lỗi xảy ra: "+t.response.data.message):v.error("Có lỗi xảy ra: "+t.message)}finally{o.loading=!1}},D=c(null),J=e=>{const t=e.target.files[0];this.formState.avatarFile=t},G={labelCol:{span:4},wrapperCol:{span:14}},B=()=>{w.value.resetFields()},M=()=>{F.GetOptionsLevelManage().then(e=>{g.optionsLevelManage=e.data,o.levelManage=e.data[0].value}).catch(e=>{console.log(e)})},E=(e,t)=>t.label.toLowerCase().indexOf(e.toLowerCase())>=0,$=()=>{F.GetOptionsRole().then(e=>{g.optionsRole=e.data,o.roleID=e.data[0].value}).catch(e=>{console.log(e)})},V=(e,t)=>t.label.toLowerCase().indexOf(e.toLowerCase())>=0,A=()=>{F.GetOptionsStatus().then(e=>{g.optionsStatus=e.data,o.status=e.data[0].value}).catch(e=>{console.log(e)})},z=()=>{history.length>1?history.go(-1):this.$router.push("/")},K=(e,t)=>t.label.toLowerCase().indexOf(e.toLowerCase())>=0;Z(()=>{k(),B(),M(),A(),$()});const j=e=>{var t=se.GetBase64(e.target.files[0]);t.then(d=>{o.urlAvatar=d,o.rmavatar="no"}).catch(d=>{console.log(d)})},H=()=>{o.urlAvatar=null,o.rmavatar="yes"};return{...x(g),authStoreClaim:a,handleChange:C,previewFiles:r,errors:R,formState:o,storeTypes:f,fileAvatar:D,formRef:w,rules:_,layout:G,resetForm:B,handleFileUpload:J,getOptionsLevelManage:M,getOptionsStatus:A,getOptionsRole:$,filterOptionLevelManage:E,filterOptionRole:V,filterOptionStatus:K,users:g,createUsers:q,handleChangeUpload:j,handleRemoveAvatar:H,goBack:z}}}),le={class:"row mb-3"},ie=m("div",{class:"col-12"},[m("h1",null,"Hãy bắt đầu tạo thông tin về cửa hàng của bạn")],-1),de={class:"col-12 col-sm-12 mb-3"},me={class:"row"},ue={class:"col-12 col-sm-9"},ce={key:0,class:"text-danger"},pe={key:0,class:"text-danger"},ge={key:0,class:"text-danger"},fe={class:"avatar-container"},he=["src"],ve=["src"],ye=m("span",null,"Quay lại",-1);function be(a,s,b,g,R,w){const o=p("a-input"),i=p("a-form-item"),S=p("a-select-option"),C=p("a-select"),f=p("a-button"),_=p("a-form"),k=p("a-card");return u(),P(k,{style:{width:"100%"}},{default:l(()=>[m("div",le,[ie,m("div",de,[n(_,te({class:"p-3",name:"custom-validation",ref:"formRef",model:a.formState,rules:a.rules},a.layout,{onFinish:s[5]||(s[5]=r=>a.createUsers())}),{default:l(()=>[m("div",me,[m("div",ue,[n(i,{ref:"name",label:"Tên cửa hàng",required:"",name:"name"},{default:l(()=>[n(o,{value:a.formState.name,"onUpdate:value":s[0]||(s[0]=r=>a.formState.name=r)},null,8,["value"]),a.errors&&a.errors.name?(u(),h("small",ce,y(a.errors.name[0]),1)):L("",!0)]),_:1},512),n(i,{ref:"address",label:"Địa chỉ",required:"",name:"address"},{default:l(()=>[n(o,{value:a.formState.address,"onUpdate:value":s[1]||(s[1]=r=>a.formState.address=r)},null,8,["value"]),a.errors&&a.errors.address?(u(),h("small",pe,y(a.errors.UserName[0]),1)):L("",!0)]),_:1},512),n(i,{ref:"phonenumber",label:"Số điện thoại",required:"",name:"phonenumber"},{default:l(()=>[n(o,{value:a.formState.phonenumber,"onUpdate:value":s[2]||(s[2]=r=>a.formState.phonenumber=r)},null,8,["value"]),a.errors&&a.errors.phonenumber?(u(),h("small",ge,y(a.errors.phonenumber[0]),1)):L("",!0)]),_:1},512),n(i,{ref:"storeTypeId",label:"Loại cửa hàng",required:"",name:"storeTypeId"},{default:l(()=>[n(C,{value:a.formState.storeTypeId,"onUpdate:value":s[3]||(s[3]=r=>a.formState.storeTypeId=r),style:{width:"100%"},placeholder:"Chọn loại cửa hàng",onChange:a.handleChange},{default:l(()=>[(u(!0),h(ae,null,ee(a.storeTypes,r=>(u(),P(S,{key:r.storeTypeId,value:r.storeTypeId},{default:l(()=>[T(y(r.storeTypeName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onChange"])]),_:1},512),n(i,{label:"Ảnh đại diện mới"},{default:l(()=>[m("input",{type:"file",onChange:s[4]||(s[4]=(...r)=>a.previewFiles&&a.previewFiles(...r))},null,32),m("div",fe,[a.newImage?(u(),h("img",{key:0,src:a.newImage,class:"avatar",alt:"avatar"},null,8,he)):(u(),h("img",{key:1,src:a.formState.avatarProduct,class:"avatar",alt:"avatar"},null,8,ve))])]),_:1}),n(i,{"wrapper-col":{span:14,offset:4}},{default:l(()=>[n(f,{onClick:a.goBack,class:"me-0 me-sm-2 mb-3 mb-sm-0"},{default:l(()=>[ye]),_:1},8,["onClick"]),n(f,{class:"me-0 me-sm-2 mb-3 mb-sm-0 bg-info text-light",onClick:a.resetForm},{default:l(()=>[T("Reset")]),_:1},8,["onClick"]),n(f,{type:"primary","html-type":"submit",class:"bg-success",loading:a.formState.loading},{default:l(()=>[T("Lưu")]),_:1},8,["loading"])]),_:1})])])]),_:1},16,["model","rules"])])])]),_:1})}const ke=re(ne,[["render",be]]);export{ke as default};
