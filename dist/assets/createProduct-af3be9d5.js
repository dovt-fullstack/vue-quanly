import{d as H,$ as X,a as d,q as Z,U as x,r as $,s as ee,t as te,a0 as ae,x as i,y as p,W as U,F as s,Q as A,V as C,C as c,b as r,I as g,z as y,E as S,M as T,a1 as oe,N as re,a2 as se}from"./index-cdcf547c.js";import{u as ne}from"./use-menu-b48628b9.js";import{A as R,B as le}from"./BaseCommon-4bb1467d.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";const ue=H({components:{DeleteOutlined:X},setup(){ne().onSelectedKeys(["admin-users"]);const t=d(Z().user.roleClaimDetail),l="http://localhost:9000",B=x(),m=$({optionsLevelManage:[],optionsRole:[],optionsStatus:[]}),M=d({}),k=d(),b=ee(),f=JSON.parse(localStorage.getItem("token")),h=b.params.id,o=$({productTypeId:"",productName:"",fullName:"",price:"",description:"",producttypename:"",productTypeName:"",avatar:"",avatarFile:null,loading:!1}),u=d([]),v=d(null),N=d(""),_=d(null),L=e=>{console.log("Selected productTypeName:",e),console.log("formState.productTypeName:",this.formState.productTypeName)},O={productName:[{required:!0,message:"name không để trống.",trigger:"change"}],fullName:[{required:!1,message:" không để trống.",trigger:"change"}]},n={labelCol:{span:4},wrapperCol:{span:14}},P=()=>{k.value.resetFields()},D=async()=>{try{const e=await A.get(`${l}/api/v1/management/${h}/producttype/view`,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${f}`}});e.data.status==="OK"?(console.log(e.data),u.value=e.data.data):console.error(e.data.message)}catch(e){console.error(e)}},I=()=>{history.length>1?history.go(-1):this.$router.push("/")},G=()=>{R.GetOptionsLevelManage().then(e=>{m.optionsLevelManage=e.data,o.levelManage=e.data[0].value}).catch(e=>{console.log(e)})},q=(e,a)=>a.label.toLowerCase().indexOf(e.toLowerCase())>=0,E=()=>{R.GetOptionsRole().then(e=>{m.optionsRole=e.data,o.roleID=e.data[0].value}).catch(e=>{console.log(e)})},V=(e,a)=>a.label.toLowerCase().indexOf(e.toLowerCase())>=0,z=()=>{R.GetOptionsStatus().then(e=>{m.optionsStatus=e.data,o.status=e.data[0].value}).catch(e=>{console.log(e)})},J=(e,a)=>a.label.toLowerCase().indexOf(e.toLowerCase())>=0,K=e=>{const a=e.target.files[0];o.avatarFile=a},Q=()=>{const e=new FormData;o.loading=!0;try{if(e.append("producttypename",o.productTypeName),o.price)e.append("price",o.price);else throw new Error("Price is missing");if(o.productName)e.append("name",o.productName);else throw new Error("Product Name is missing");if(o.description)e.append("description",o.description);else throw new Error("Description is missing");v.value&&e.append("avatar",v.value);for(let a of e.entries())console.log(a[0]+", "+a[1]);A.post(`${l}/api/v1/management/${h}/product/insert`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${f}`}}).then(a=>{C.success("Tạo mới thành công!"),B.push({name:"ProductByStore",params:{id:h}})}).catch(a=>{console.log(a)})}catch(a){console.error("Error during form submission:",a),C.error("Có lỗi xảy ra: "+a.message)}finally{o.loading=!1}},j=e=>{const a=e.target.files[0];if(!a)return;if(!(a.type==="image/jpeg"||a.type==="image/png")){C.error("You can only upload JPG/PNG file!");return}if(!(a.size/1024/1024<2)){C.error("Image must smaller than 2MB!");return}const F=new FileReader;F.onloadend=()=>{N.value=F.result,v.value=a},F.readAsDataURL(a)};te(()=>{P(),D()});const W=e=>{var a=le.GetBase64(e.target.files[0]);a.then(w=>{o.urlAvatar=w,o.rmavatar="no"}).catch(w=>{console.log(w)})},Y=()=>{o.urlAvatar=null,o.rmavatar="yes"};return{...ae(m),authStoreClaim:t,errors:M,formState:o,fileAvatar:_,formRef:k,rules:O,layout:n,resetForm:P,productTypes:u,handleChange:L,handleFileUpload:K,getOptionsLevelManage:G,getOptionsStatus:z,getOptionsRole:E,filterOptionLevelManage:q,filterOptionRole:V,filterOptionStatus:J,users:m,createUsers:Q,handleChangeUpload:W,handleRemoveAvatar:Y,goBack:I,newImage:N,previewFiles:j}}}),ce={class:"row mb-3"},de={class:"col-12"},pe=c("h1",null,null,-1),me={class:"col-12 col-sm-12 mb-3"},fe={class:"row"},ge={class:"col-12"},he={key:0,class:"text-danger"},ve={key:0,class:"text-danger"},_e={key:0,class:"text-danger"},ye={class:"avatar-container"},be=["src"],Ne=c("span",null,"Quay lại",-1);function we(t,l,B,m,M,k){const b=i("router-link"),f=i("a-breadcrumb-item"),h=i("a-breadcrumb"),o=i("a-input"),u=i("a-form-item"),v=i("a-select-option"),N=i("a-select"),_=i("a-button"),L=i("a-form"),O=i("a-card");return p(),U(O,{style:{width:"100%"}},{default:s(()=>[c("div",ce,[c("div",de,[r(h,null,{default:s(()=>[r(f,null,{default:s(()=>[r(b,{to:{name:"admin-dashboards"}},{default:s(()=>[g("Trang chủ")]),_:1})]),_:1}),r(f,null,{default:s(()=>[r(b,{to:{name:"admin-users"}},{default:s(()=>[g("Product")]),_:1})]),_:1}),r(f,null,{default:s(()=>[g("Thêm mới")]),_:1})]),_:1}),pe]),c("div",me,[r(L,se({class:"p-3",name:"custom-validation",ref:"formRef",model:t.formState,rules:t.rules},t.layout,{onFinish:l[5]||(l[5]=n=>t.createUsers())}),{default:s(()=>[c("div",fe,[c("div",ge,[r(u,{ref:"productName",label:"Tên sản phẩm",required:"",name:"productName"},{default:s(()=>[r(o,{value:t.formState.productName,"onUpdate:value":l[0]||(l[0]=n=>t.formState.productName=n)},null,8,["value"]),t.errors&&t.errors.UserName?(p(),y("small",he,S(t.errors.UserName[0]),1)):T("",!0)]),_:1},512),r(u,{ref:"price",label:"Giá bán",required:"",name:"price"},{default:s(()=>[r(o,{value:t.formState.price,"onUpdate:value":l[1]||(l[1]=n=>t.formState.price=n)},null,8,["value"]),t.errors&&t.errors.price?(p(),y("small",ve,S(t.errors.price[0]),1)):T("",!0)]),_:1},512),r(u,{ref:"description",label:"Mô tả",required:"",name:"description"},{default:s(()=>[r(o,{value:t.formState.description,"onUpdate:value":l[2]||(l[2]=n=>t.formState.description=n)},null,8,["value"]),t.errors&&t.errors.description?(p(),y("small",_e,S(t.errors.description[0]),1)):T("",!0)]),_:1},512),r(u,{ref:"productTypeName",label:"Loại sản phẩm",name:"productTypeId"},{default:s(()=>[r(N,{value:t.formState.productTypeName,"onUpdate:value":l[3]||(l[3]=n=>t.formState.productTypeName=n),style:{width:"100%"},placeholder:"Chọn loại sản phẩm",onChange:t.handleChange},{default:s(()=>[(p(!0),y(re,null,oe(t.productTypes,n=>(p(),U(v,{key:n.productTypeName,value:n.productTypeName},{default:s(()=>[g(S(n.productTypeName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onChange"])]),_:1},512),r(u,{label:"Ảnh đại diện mới"},{default:s(()=>[c("input",{type:"file",onChange:l[4]||(l[4]=(...n)=>t.previewFiles&&t.previewFiles(...n))},null,32),c("div",ye,[t.newImage?(p(),y("img",{key:0,src:t.newImage,class:"avatar",alt:"avatar"},null,8,be)):T("",!0)])]),_:1}),r(u,{"wrapper-col":{span:14,offset:4}},{default:s(()=>[r(_,{onClick:t.goBack,class:"me-0 me-sm-2 mb-3 mb-sm-0"},{default:s(()=>[Ne]),_:1},8,["onClick"]),r(_,{class:"me-0 me-sm-2 mb-3 mb-sm-0 bg-info text-light",onClick:t.resetForm},{default:s(()=>[g("Reset")]),_:1},8,["onClick"]),r(_,{type:"primary","html-type":"submit",class:"bg-success",loading:t.formState.loading},{default:s(()=>[g("Lưu")]),_:1},8,["loading"])]),_:1})])])]),_:1},16,["model","rules"])])])]),_:1})}const Oe=ie(ue,[["render",we]]);export{Oe as default};
