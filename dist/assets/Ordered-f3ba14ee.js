import{d as K,R as F,D as W,B as j,S as X,s as Y,a as m,U as Z,r as tt,t as at,x as v,y as d,z as c,b as p,C as t,F as w,G as et,N as H,a1 as z,V as D,O as ot,I as nt,E as h,M as A,J as st,K as it}from"./index-cdcf547c.js";import{H as rt}from"./HeaderCustomer-c7f48903.js";import"./use-menu-b48628b9.js";import{_ as lt}from"./_plugin-vue_export-helper-c27b6911.js";const dt=K({components:{"a-form":F,"a-form-item":F.Item,"a-drawer":W,"a-button":j,"a-input-number":X,Header:rt},setup(){const n=Y(),s="http://localhost:9000";n.params.id;const $=m([]),I=m([]),b=m(!1),S=m(!1),_=m(0),P=m(null),O=Z(),T=JSON.parse(localStorage.getItem("auth")),i=JSON.parse(localStorage.getItem("token")),C=m([]),y=m(""),a=tt({currentPage:1,pageSize:10,totalItems:0,totalPages:0}),r=()=>{b.value=!0},N=()=>{S.value=!0},M=()=>{S.value=!1},B=()=>{b.value=!1},f=async()=>{try{const e=await axios.get(`${s}/api/v1/customer/cartitem/view`,{headers:{Authorization:`Bearer ${i}`}});console.log(e.data,"data"),$.value=e.data.data,_.value=0,await e.data.data.forEach(o=>{_.value+=o.priceTotal})}catch(e){console.error(e)}},V=async()=>{const e=await axios.get(`${s}/api/v1/customer/favor/view`,{headers:{Authorization:`Bearer ${i}`}});I.value=e.data.data},x=async e=>{try{await axios.get(`${s}/api/v1/customer/order/delete/${e}`,{headers:{Authorization:`Bearer ${i}`}}),D.success("Hủy thành công"),setTimeout(()=>{window.location.reload()},350)}catch(o){console.error(o)}},U=async e=>{const o=new FormData;o.append("storeid",e);try{await axios({method:"delete",url:`${s}/api/v1/customer/favor/remove`,data:o,headers:{Authorization:`Bearer ${i}`,"Content-Type":"multipart/form-data"}}),D.success("Hủy thành công"),setTimeout(()=>{window.location.reload()},350)}catch(l){console.error(l)}},k=async(e,o,l="")=>{try{const u=await axios.get(`${s}/api/v1/customer/orderdetail/view`,{headers:{Authorization:`Bearer ${i}`},params:{page:e,size:o,keyword:l}});console.log(u.data,"data"),a.totalItems=u.data.pagination.totalItems,a.totalPages=u.data.pagination.totalPages,C.value=u.data.data}catch(u){console.error(u)}},q=(e,o)=>{a.currentPage=e,a.pageSize=o,k(e,o,y.value)},G=()=>{a.currentPage=1,k(a.currentPage,a.pageSize,y.value)},E=async e=>{const o=new FormData;o.append("cartitemid",e),await axios.post(`${s}/api/v1/customer/order/insert/cartitem`,o,{headers:{Authorization:`Bearer ${i}`}}),alert("Mua thành công"),f()};console.log(_,"1");const L=async e=>{new FormData;try{const o=await axios.get(`${s}/api/v1/customer/cartitem/delete?cartitemid=${e}`,{headers:{Authorization:`Bearer ${i}`}});f()}catch(o){console.error(o)}},Q=async e=>{try{if(e.quantity<=1){new FormData().append("cartitemid",e.cartItemId);const l=await axios.get(`${s}/api/v1/customer/cartitem/delete?cartitemid=${e.cartItemId}`,{headers:{Authorization:`Bearer ${i}`}})}else{const o=new FormData,l=e.quantity-1;o.append("quantity",l),o.append("cartitemid",e.cartItemId),console.log(l);const u=await axios.put(`${s}/api/v1/customer/cartitem/update`,o,{headers:{Authorization:`Bearer ${i}`}})}f()}catch(o){console.error(o)}},R=async e=>{try{const o=new FormData,l=e.quantity+1;o.append("quantity",l),o.append("cartitemid",e.cartItemId),console.log(l);const u=await axios.put(`${s}/api/v1/customer/cartitem/update`,o,{headers:{Authorization:`Bearer ${i}`}});f()}catch(o){console.error(o)}},J=()=>{P.value.validateFields(e=>{e?D.error("Please input the correct quantity!"):(D.success("Quantity submitted successfully!"),B())})};return at(()=>{f(),V(),k(a.currentPage,a.pageSize)}),{router:O,route:n,product:$,userLocal:T,deleteProduct:L,decrement:Q,increment:R,allTotal:_,byProductCart:E,isDrawerVisible:b,showDrawer:r,handleClose:B,handleSubmit:J,isDrawerVisible2:S,pageParam:a,handleClose2:M,showDrawer2:N,cancelOderMyFarvor:U,myOrder:C,myFarve:I,cancelOder:x,searchKeyword:y,onChange:q,onSearch:G}}}),g=n=>(st("data-v-a0859756"),n=n(),it(),n),ct={id:"wrapper"},ht={id:"main"},ut={class:"orderbox"},mt=g(()=>t("h1",{style:{padding:"30px"}},"Danh sách đơn đã đặt",-1)),pt={class:"giohang orderhome"},vt={class:"row mb-3"},gt={class:"col-12"},_t={name:"giohang",id:"cart"},yt={class:"listcart"},ft={class:"oimg"},wt=["src","alt"],bt={class:"oname"},St={style:{float:"left"}},Ct={key:0,style:{float:"right"}},Dt=["onClick"],$t=g(()=>t("input",{type:"submit",name:"_w_action[UpdatePOST]",style:{display:"none"}},null,-1)),It=g(()=>t("input",{type:"hidden",name:"_w_action",value:"UpdatePOST"},null,-1)),Pt={class:"col-12"},Ot=ot('<div id="footer" data-v-a0859756><div class="f" style="padding:40px 0;" data-v-a0859756><div class="wrap flexJus" data-v-a0859756><div class="f flex" data-v-a0859756><div class="fotb" style="width:30%;padding-right:30px;" data-v-a0859756><img src="https://denled.com/Content/img/logo-foot.png" alt="Denled.com" width="286" height="60" data-v-a0859756></div><div class="fotb" style="width:50%;padding:0 40px 0 60px;" data-v-a0859756><label data-v-a0859756>SHOWROOM</label><div class="muahang f flexC" data-v-a0859756><div class="showrooms" data-v-a0859756><ul data-v-a0859756><li data-v-a0859756>Hệ thống hỗ trợ quản lí và bán hàng tạp hóa</li><li data-v-a0859756><span data-v-a0859756>Địa chỉ 1 : </span>21C Trần Duy Hưng, Cầu Giấy, HN </li><li data-v-a0859756><span data-v-a0859756>Hotline : </span><a href="tel:0933665115" data-v-a0859756>0933.66.5115</a></li></ul></div></div></div><div class="fotb" data-v-a0859756><label data-v-a0859756>THÔNG TIN - HƯỚNG DẪN</label><ul data-v-a0859756><li data-v-a0859756><a title="Giới Thiệu Hệ Thống" rel="nofollow" href="/" data-v-a0859756>Giới Thiệu Hệ Thống</a></li><li data-v-a0859756><a title="Giao hàng &amp; Thanh toán" rel="nofollow" href="/" data-v-a0859756>Giao hàng &amp; Thanh toán</a></li><li data-v-a0859756><a title="Hướng dẫn mua hàng Online" rel="nofollow" href="/" data-v-a0859756>Hướng dẫn mua hàng Online</a></li><li data-v-a0859756><a title="Quy chế hoạt động" rel="nofollow" href="/" data-v-a0859756>Quy chế hoạt động</a></li></ul></div></div></div></div><div class="f p10 cen trang copyright" data-v-a0859756> © 2024 bản quyền thuộc về HungNL@gmail.com <a href="https://denled.com" title="Siêu thị đèn LED" data-v-a0859756>denled.com</a></div><ul id="panel" data-v-a0859756><li data-v-a0859756><img src="https://denled.com/Content/img/totop.svg" alt="To top" width="45" height="45" data-v-a0859756></li><li style="padding-top:10px;padding-bottom:10px;" data-v-a0859756><img alt="Messenger" src="https://denled.com/Content/img/messenger.svg" width="45" height="45" data-v-a0859756></li><li data-v-a0859756><img alt="Phone" src="https://denled.com/Content/img/phone.svg" width="45" height="45" data-v-a0859756></li></ul><div class="zalo-chat-widget" data-oaid="2839194858446814357" data-welcome-message="Rất vui khi được hỗ trợ bạn!. Nếu bạn không thể chờ thì hãy gọi hoặc nhắn tin đến số điện thoại này 0973.66.5115." data-autopopup="1800" data-width="500" data-height="500" style="right:12px;" data-v-a0859756></div></div>',1),Tt={class:"giohang orderhome"},Nt={name:"giohang",id:"cart"},kt={class:"listcart"},Ht={class:"oimg"},zt=["src","alt"],Bt={class:"oname"},Ft={style:{float:"left"}},At={key:0,style:{float:"right"}},Mt=["onClick"],Vt=g(()=>t("input",{type:"submit",name:"_w_action[UpdatePOST]",style:{display:"none"}},null,-1)),xt=g(()=>t("input",{type:"hidden",name:"_w_action",value:"UpdatePOST"},null,-1)),Ut={class:"giohang orderhome"},qt={name:"giohang",id:"cart"},Gt={class:"listcart"},Et={class:"oimg"},Lt=["src","alt"],Qt={class:"oname"},Rt={style:{float:"right"}},Jt=["onClick"],Kt=g(()=>t("input",{type:"submit",name:"_w_action[UpdatePOST]",style:{display:"none"}},null,-1)),Wt=g(()=>t("input",{type:"hidden",name:"_w_action",value:"UpdatePOST"},null,-1));function jt(n,s,$,I,b,S){const _=v("Header"),P=v("a-input"),O=v("a-form-item"),T=v("a-button"),i=v("a-form"),C=v("a-pagination"),y=v("a-drawer");return d(),c("div",ct,[p(_),t("div",ht,[t("div",ut,[mt,t("div",pt,[t("div",vt,[t("div",gt,[p(i,{onSubmit:et(n.onSearch,["prevent"])},{default:w(()=>[p(O,null,{default:w(()=>[p(P,{placeholder:"Tìm kiếm sản phẩm",value:n.searchKeyword,"onUpdate:value":s[0]||(s[0]=a=>n.searchKeyword=a),onPressEnter:n.onSearch},null,8,["value","onPressEnter"])]),_:1}),p(T,{type:"primary",onClick:n.onSearch},{default:w(()=>[nt("Tìm kiếm")]),_:1},8,["onClick"])]),_:1},8,["onSubmit"])])]),t("form",_t,[t("ul",yt,[(d(!0),c(H,null,z(n.myOrder,a=>{var r;return d(),c("li",{key:a.orderDetailId,class:"cartitem"},[t("div",ft,[t("a",null,[t("img",{src:a.productImg,alt:n.product.title},null,8,wt)])]),t("div",bt,[t("h3",null,h(a.productName),1),t("label",null,h(a.orderStatusName),1),t("label",St,h((r=a.priceTotal)==null?void 0:r.toLocaleString())+"₫",1),a.orderStatusName=="Đặt hàng thành công"?(d(),c("div",Ct,[t("button",{type:"button",onClick:N=>n.cancelOder(a.orderDetailId),class:"btn"}," Hủy đơn ",8,Dt)])):A("",!0)])])}),128))]),$t,It]),t("div",Pt,[p(C,{onChange:n.onChange,current:n.pageParam.currentPage,"onUpdate:current":s[1]||(s[1]=a=>n.pageParam.currentPage=a),total:n.pageParam.totalItems,pageSize:n.pageParam.pageSize,"show-total":(a,r)=>`${r[0]}-${r[1]} của ${a} sản phẩm`,class:"mt-2 text-end"},null,8,["onChange","current","total","pageSize","show-total"])])])])]),Ot,t("div",null,[p(y,{title:"Danh sách đơn hàng đã đặt",visible:n.isDrawerVisible,width:850,onClose:n.handleClose,destroyOnClose:!0},{default:w(()=>[t("div",Tt,[t("form",Nt,[t("ul",kt,[(d(!0),c(H,null,z(n.myOrder,a=>{var r;return d(),c("li",{key:a.orderDetailId,class:"cartitem"},[t("div",Ht,[t("a",null,[t("img",{src:a.productImg,alt:n.product.title},null,8,zt)])]),t("div",Bt,[t("h3",null,h(a.productName),1),t("label",null,h(a.orderStatusName),1),t("label",Ft,h((r=a.priceTotal)==null?void 0:r.toLocaleString())+"₫",1),a.orderStatusName=="Đặt hàng thành công"?(d(),c("div",At,[t("button",{type:"button",onClick:N=>n.cancelOder(a.orderDetailId),class:"btn"}," Hủy đơn ",8,Mt)])):A("",!0)])])}),128))]),Vt,xt])])]),_:1},8,["visible","onClose"]),p(y,{title:"Danh sách cửa hàng bạn thích",visible:n.isDrawerVisible2,width:850,onClose:n.handleClose2,destroyOnClose:!0},{default:w(()=>[t("div",Ut,[t("form",qt,[t("ul",Gt,[(d(!0),c(H,null,z(n.myFarve,a=>(d(),c("li",{key:a.orderDetailId,class:"cartitem"},[t("div",Et,[t("a",null,[t("img",{src:a.image,alt:a.title},null,8,Lt)])]),t("div",Qt,[t("h3",null,h(a.storeName),1),t("label",null,h(a.orderStatusName),1),t("p",null,h(a.storeAddress),1),t("div",Rt,[t("button",{type:"button",onClick:r=>n.cancelOderMyFarvor(a.storeId),class:"btn"}," Hủy thích ",8,Jt)])])]))),128))]),Kt,Wt])])]),_:1},8,["visible","onClose"])])])}const aa=lt(dt,[["render",jt],["__scopeId","data-v-a0859756"]]);export{aa as default};
